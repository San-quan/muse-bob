# 三宝订阅聚合系统

> 基于 Cloudflare Workers 的智能订阅聚合与节点管理系统，专为海外回国养号场景优化

## ✨ 核心特性

- 🔄 **智能聚合** - 多订阅源自动合并，支持 vless/vmess/trojan/ss 协议
- 🛡️ **稳定优先** - 600秒测速间隔，固定IP不频繁切换，避免风控
- 🚫 **自动断网** - 国内节点全挂自动 REJECT，防止海外IP触发风控
- 🏙️ **城市分组** - 北京/上海/广州/深圳/成都精细化分组
- 🔍 **健康检查** - 每3天自动检测，连续6天失败自动清理
- 📱 **TG通知** - 节点变化、健康报告实时推送
- 🎨 **Cyberpunk UI** - 赛博朋克风格管理界面，支持二维码
- 🔐 **防配置覆盖** - GitHub托管配置，不被机场订阅覆盖

## 🎯 使用场景

适用于海外账号回国维护，需要稳定国内IP避免频繁切换的场景

## 📦 部署状态

- **订阅地址**: `https://baobao.snk567.cc/sub?token=sanbao`
- **管理页面**: `https://baobao.snk567.cc/sanbao`
- **Worker版本**: c33fbe04
- **健康检查**: 每3天 08:00 (香港时间)

## 🏗️ 技术架构

- **运行环境**: Cloudflare Workers
- **存储**: KV Namespace (主节点 + 访客)
- **定时任务**: Cron Triggers (0 0 */3 * *)
- **配置管理**: GitHub托管 clash_config_optimized.ini
- **通知系统**: Telegram Bot API

## 📝 配置亮点

### Failover策略
```ini
🔄 回国专线 → 北京 → 上海 → 广州 → 深圳 → 成都 → REJECT
```
当所有国内节点失败时自动断网，避免切换到海外节点

### 节点清理规则
- ✅ 节点正常 → 保留
- ⚠️ 首次失败 → 标记待观察(保留)
- 🗑️ 连续2次失败(6天) → 自动删除

## 🚀 快速开始

1. 访问管理页面添加订阅链接
2. 将订阅地址导入 Clash/Surge 客户端
3. 选择 `🔄 回国专线` 策略组使用

## 📊 监控指标

系统每3天发送健康报告:
- ✅ 健康节点数量
- ⚠️ 待观察节点(首次失败)
- 🗑️ 已清理节点(连续失败)

## 🔧 维护

配置文件: `clash_config_optimized.ini` (85行纯净代码)
- 无注释干扰
- GitHub版本控制
- 防止订阅覆盖

---

**Powered by Cloudflare Workers · Optimized for 回国养号**